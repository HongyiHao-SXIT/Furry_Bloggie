以下是根据你提供的代码文件生成的 README 文件，该文件详细介绍了项目的整体结构、每个文件的功能以及使用方法。

# 数学建模比赛光伏电站问题解决方案

## 项目概述
本项目围绕光伏电站相关问题展开，涵盖数据处理、指标计算、可视化分析以及优化策略制定等多个方面，旨在解决光伏电站发电量计算、清洗频率优化等实际问题。

## 项目结构
项目主要分为三个部分，分别对应不同的问题，每个部分包含多个代码文件，用于实现特定的功能。具体结构如下：
```
A_Solution/
├── A_Q2/
│   ├── zhexiantu.m
│   ├── zhibiao.m
│   ├── qingxipinlv.m
│   ├── Q3.m
├── A_Q3/
│   ├── zuiyouqingxipinlv.m
│   ├── jiehe.m
├── Q1.py
├── Q2.py
```

## 文件功能说明

### 第一部分：数据处理与整合（Q1.py）
- **功能**：读取四个光伏电站的发电数据、环境数据和天气数据，进行数据清洗和预处理，包括处理负值、填充缺失值、按小时聚合数据等操作，最后将四个电站的数据合并并保存为新的 Excel 文件。
- **使用方法**：确保各电站数据文件路径正确，运行该 Python 脚本即可生成清洗后的数据文件。
```python
python Q1.py
```

### 第二部分：指标计算与可视化（A_Q2 文件夹）
#### 1. `zhexiantu.m`
- **功能**：从 Excel 文件中读取四个电站的每小时数据，计算理论发电量、性能比（PR）和实际与理论发电量的差值，然后绘制每个电站的 PR 值、发电量差值、辐照度、当前温度和湿度的折线图。
- **使用方法**：将 Excel 文件路径替换为实际路径，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q2/zhexiantu.m')
```

#### 2. `zhibiao.m`
- **功能**：加载四个电站的数据，根据不同的装机容量计算理论发电量和 PR 值，为数据添加站点标识，合并所有数据，根据清洗预警规则标记需要清洗的数据，并将结果输出到 Excel 文件。
- **使用方法**：确保 Excel 文件路径正确，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q2/zhibiao.m')
```

#### 3. `qingxipinlv.m`
- **功能**：假设已加载合并后的数据，模拟不同清洗频率下的发电量变化，绘制折线图展示清洗频率对发电量的影响。
- **使用方法**：确保合并后的数据文件路径正确，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q2/qingxipinlv.m')
```

#### 4. `Q3.m`
- **功能**：导入光伏电站数据，设置不同的清洗策略，模拟清洗收益计算，输出各策略的净收益和触发次数表格，并绘制对比图，最后推荐净收益最大的策略。
- **使用方法**：确保 Excel 文件在当前目录且列名是英文，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q2/Q3.m')
```

### 第三部分：清洗频率优化（A_Q3 文件夹）
#### 1. `zuiyouqingxipinlv.m`
- **功能**：加载合并后的数据，模拟不同清洗频率下的清洗成本和发电量，计算综合成本，绘制不同清洗频率下的总成本与发电量变化图，输出最优清洗频率。
- **使用方法**：确保合并后的数据文件路径正确，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q3/zuiyouqingxipinlv.m')
```

#### 2. `jiehe.m`
- **功能**：考虑清洗价格的变化，模拟不同清洗价格和清洗频率下的总成本和总发电量，绘制相应的关系图，输出每个清洗价格对应的最优清洗频率。
- **使用方法**：确保合并后的数据文件路径正确，在 MATLAB 中运行该脚本。
```matlab
% 在 MATLAB 命令窗口运行
run('A_Solution/A_Q3/jiehe.m')
```

### 第四部分：GDI 阈值分析（Q2.py）
- **功能**：读取四电站的 GDI 数据，进行数据清洗，按 GDI 分组计算平均发电量，剔除发电量波动异常的 GDI 区间，自动寻找拐点确定推荐清洗的 GDI 阈值，并绘制可视化图表。
- **使用方法**：将 Excel 文件路径替换为实际路径，运行该 Python 脚本。
```python
python Q2.py
```

## 注意事项
- 请确保所有 Excel 文件路径正确，且文件格式符合代码要求。
- 在 MATLAB 中运行脚本时，确保当前工作目录包含所需的文件。
- 在 Python 脚本中，可能需要安装必要的库，如 `pandas`、`numpy` 和 `matplotlib`，可以使用以下命令进行安装：
```sh
pip install pandas numpy matplotlib
```

通过以上步骤，你可以完整地运行项目中的各个脚本，对光伏电站数据进行处理、分析和优化。